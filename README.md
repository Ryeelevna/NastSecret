# Настя – Настольная секретарша

Настя – это удобный планнер задач, включающий в себя стандартные функции программ такого рода, а также дополнительные функции, такие как разнообразные графики и метки в календаре, позволяющие подробно анализировать вашу продуктивность и корректировать деятельность. Он подходит как для повседневного ведения личных дел, так и для работы.

## Возможности

| <!-- -->     | <!-- -->       |
|:-------------|:---------------|
| **Создание задач с набором различных настроек** | -	Ввод названия, описания, выбор уровня приоритета. |
| <!-- -->     | -	Присвоение конфигурируемых категорий. |
| <!-- -->     | -	Добавление подзадач. |
| <!-- -->     | -	Настраиваемый просмотр списка добавленных задач (исключение низкоприоритетных, исключение добавленных в расписание). |
| <!-- -->     | -	Выполнение задач с сохранением в истории. |
| <!-- -->     | -	Просмотр подробностей по каждой задаче: сохранённые данные, а также история пропусков и выполнений, включая подзадачи. |
| **Создание плана выполнения задач** | -	Произвольный выбор дат начала и конца плана. |
| <!-- -->     | -	Внесение задач в расписание, назначение на даты и выбор порядка расположения в пределах дня. |
| <!-- -->     | -	Внесение задач в расписание путём выбора даты из окна редактирования задачи. |
| <!-- -->     | -	Свободное расположение подзадач в расписании, не зависящее от позиции и даже наличия в нём основной задачи. |
| <!-- -->     | -	Добавление мелких запланированных задач с ограниченным набором настроек и с дополнительной опцией пропуска. |
| <!-- -->     | -	Отображение расписания в виде списка задач с сортировкой по датам, отметкой выполненных и отдельной группировкой просроченных задач. |
| <!-- -->     | -	Автозапись просрочек в историю. |
| **Просмотр истории выполнения задач разными способами** | -	Список выполненных и пропущенных задач с сортировкой по датам. |
| <!-- -->     | -	Календарь в виде пролистываемых месяцев с цветными метками на датах, соответствующими категориям выполненных в эти дни задач. |
| <!-- -->     | -	Выбор дат в календаре и просмотр выполнений и пропусков по каждому дню. |
| **Просмотр графиков по прошедшему, требуемому и предсказываемому выполнению задач** | -	График выполнений – количество выполненных задач каждый день. |
| <!-- -->     | -	Плановая норма – рассчитанное количество задач на каждый день, которое необходимо выполнить, чтобы вовремя завершить план. |
| <!-- -->     | -	Плановый график бездействия – как будут выглядеть графики, если не выполнять запланированные задачи. |
| <!-- -->     | -	График предсказания – как будут выглядеть графики, если продолжать выполнять задачи с той же интенсивностью, а также если скорректировать план согласно рекомендациям. |
| <!-- -->     | -	График отставания/опережения плана (по задачам) – количество просроченных задач или перевыполнений каждый день по сравнению с составленным планом. |
| <!-- -->     | -	График отставания/опережения плана (по дням) – количество дней, на которые пользователь отстаёт от плана или опережает его. |
| <!-- -->     | -	Временны́е границы на графиках: недели, месяцы, годы, границы плана, а также предсказываемая дата завершения плана. |
| <!-- -->     | -	Выбор типа рассматриваемых задач для построения графиков. |
| <!-- -->     | -	Выбор одного из 4-х временны́х масштабов для отображения графиков: неделя, месяц, год и план. |
| <!-- -->     | -	Автоматическое масштабирование по вертикали и расположение графиков на холсте. |
| <!-- -->     | -	Прокрутка графиков по вертикали и горизонтали. |
| <!-- -->     | -	Сообщения, информирующие об отставании или опережении плана, отображающие количество дней сдвига и предсказываемую дату завершения плана. |
| <!-- -->     | -	Рекомендации по корректировке расписание с указанием количества задач, которое следует назначить на каждый день. |

## Запуск

Требуется наличие установленного на ПК ***Python 3*** и модуля ***openpyxl***

Запуск программы осуществляется путём запуска файла ***nastsecret.pyw***

## Использование

Главное окно состоит из 4-х разделов, между которыми можно переключаться: задачи, расписание, история и графики.

В разделе задач можно добавлять основные задачи, просматривать их список и скрывать часть из них на основе присвоенного приоритета или наличия в расписании с помощью кнопок слева. Например, отображение только незапланированных задач помогает отдельно просматривать те, которые не были внесены в расписание и не имеют конкретной даты выполнения.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex00.png)

Основные задачи имеют ряд параметров, помимо заголовка: это описание, упомянутый выше приоритет, а также категория, позволяющая сгруппировать все задачи по областям/темам. Сортировка списка осуществляется именно по категориям.
Также имеется список подзадач и дата выполнения, которые можно указать после создания пользователем расписания.

После создания задачи, её можно редактировать, тогда в форме также отображается история выполнений: это не только непосредственно выполнение задачи, но также пропуски, если задача была запланирована на определённую дату и не была выполнена, плюс пропуски и выполнения подзадач.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex01.png)

Категории для наглядности отличаются по цвету и могут быть названы пользователем в настройках в верхнем меню. При создании задач могут использоваться и те, которым не было присвоено никакое название.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex02.png)

При выполнении задачи (кнопка с галочкой), она переносится в историю, которую можно просматривать двумя способами: обычный список с сортировкой по времени выполнения и с группировкой по датам, а также календарь.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex03.png)

В календаре каждая дата отмечается цветными метками, соответствующими цветам категорий выполненных в эти дни задач. Метки помогают оценивать динамику вашей активности в течение месяца, наблюдая распределение проделанной работы во времени, не только в общем, но и по областям. Например, преобладание меток определённого цвета в течение некоторого периода говорит о вашей сфокусированности на задачах из соответствующей области и может предупреждать о необходимости уделить больше внимания другим сферам.

Щёлкнув по дате, можно увидеть список конкретных задач, выполненных в этот день (пропущенные также отображаются, но не отмечаются метками на датах).

У каждой задачи в истории можно проверить более подробную информацию, включая параметры, а также историю выполнений.
Если у присвоенной ей категории после выполнения было изменено название, то отображается и старый, и текущий вариант.
Из этого окна доступны все переходы: от основной задачи к подзадачам и обратно, а также в форму редактирования задачи, если она ещё не была выполнена.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex04.png)

В разделе расписания, при наличии необходимости в этом, можно создать план ведения дел, выбрав произвольные даты начала и конца плана и назначив выполнение задач на определённые дни. Это чрезвычайно полезно для повышения своей эффективности путём рационального распределения личного или рабочего времени, так как это позволяет определить чёткую цель и способ её достижения, в последующем анализировать и соответствующе оптимизировать свою деятельность.

Удобный редактор расписания позволяет выделять задачи, перемещать между планом и списком незапланированных задач и расставлять их в любом порядке в расписании путём щелчка по промежуткам между ними.
Щелчок по дате позволяет выбранной задаче, если на этот день поставлена её подзадача (или наоборот), автоматически вставать к ней с нужной стороны, обеспечивая правильный порядок.

Сформированный план выглядит как список задач в порядке их выполнения и с группировкой по датам. Все выполненные задачи скрываются, сокращая список, кроме тех, которые были назначены на будущие даты – чтобы видеть, какая работа запланирована на те дни и какая часть уже сделана, - они отмечаются серым цветом. А пропущенные задачи, вне зависимости от даты, собираются в одну группу и выделяются красным цветом.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex05.png)

В режиме расписания становится доступен второй тип задач – это второстепенные задачи. Они отличаются от основных тем, что имеют сокращённый список настроек и могут существовать только внутри расписания.
Они отличаются визуально – в основном, это курсивный шрифт.

Второстепенные задачи служат для того, чтобы обозначать мелкие дела, которые появляются между делом и не требуют большой сосредоточенности (например, зайти после работы в магазин и купить молока).

У них есть дополнительная опция – это пропуск. Пропуск удаляет задачу из списка без выполнения, но от обычного удаления это отличается тем, что факт пропуска сохраняется в истории. Это применимо в тех случаях, когда мелкое дело не было выполнено, но при этом оно больше не актуально.

Ещё одно важное назначение второстепенных задач – это возможность превращаться в подзадачи к основным задачам. Это полезно тогда, когда перед человеком стоит большая работа, которую невозможно выполнить за один подход, и требуется разбиение её на этапы для эффективного выполнения.

В случае назначения второстепенной задачи в качестве этапа основной задачи, она всё ещё остаётся самостоятельной единицей и может независимо перемещаться по расписанию, за исключением одного логичного ограничения: этапы не могут устанавливаться на место в списке позже основной задачи.
То же самое работает для основных задач: их нельзя поставить раньше их собственных этапов.

Ещё одно ограничение в создании подзадач заключается в выборе категории. Она обязательно должна совпадать с категорией основной задачи, за исключением случая, когда её нет, - тогда категория подзадачи может быть выбрана любая.

У подзадач есть одна особенная характеристика – «последний этап». Это свойство облегчает управление задачами: если некая работа разбита на этапы, то логично, что выполнение последнего из них повлечёт за собой завершение основного вопроса. Чтобы исключить случаи, когда после выполнения последнего этапа пользователь может забыть отметить основную задачу как выполненную, программа делает это автоматически.
У последнего этапа имеются собственные дополнительные временны́е ограничения: он может стоять только после всех остальных этапов, и его дата обязательно должна совпадать с датой основной задачи. Между ним и основной задачей устанавливается связь, благодаря которой, при изменении даты или положения в расписании одного из них, они перемещаются вместе, а между ними невозможно вставить другие задачи.

В расписании основная задача, имеющая последний этап, окрашивается в серый цвет, чтобы не создавать ложное впечатление наличия двух заданий. При подсчёте, они также считаются за одну задачу.

Во время выбора даты выполнения как подзадачи, так и основной задачи, в календаре, для удобного ориентирования среди всех связанных задач, кружочками отмечены даты этапов, а нижним подчёркиванием – дата основной задачи. В серый цвет окрашены все те даты, которые не могут быть выбраны по тем или иным причинам: выход за пределы расписания или одно из перечисленных выше условий распределения задач, когда одни не могут стоять позже других.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex06.png)

Последний раздел – это графики. Они помогают пользователю анализировать проделанную и предстоящую работу и делать вывод о том, что необходимо изменить, чтобы оптимизировать свою деятельность.

Для всех графиков по оси X отложено время в днях, по оси Y – количество задач (за исключением последнего графика).
Для удобного просмотра имеется возможность выбора масштаба по горизонтали, когда видимую область занимает ровно одна неделя, месяц, год или же план – чтобы видеть весь период плана от начала до конца.
Масштабирование по вертикали производится автоматически – таким образом, чтобы все выбранные графики оптимально размещались на холсте, с пропорциональными размерами и достаточными отступами от краёв.
Другие части графиков, которые не попали в видимую область, также можно увидеть – используя горизонтальную полосу прокрутки. Масштаб по оси Y выбирается исходя из части графиков, изначально попавших в видимую область. При прокрутке по горизонтали, они могут выйти за пределы области, – в этом случае поможет вертикальная полоса прокрутки.
На холсте внизу отмечены даты, месяцы и годы. Их может быть недостаточно для удобной ориентации во времени, поэтому помимо них также имеются вертикальные границы:
-	между неделями – бледно-синий мелкий пунктир,
-	между месяцами – бледно-красный крупный пунктир,
-	между годами – бледно-красная жирная линия,
-	границы плана – красная гребёнка, направленная щетинками внутрь периода,
-	предсказываемая дата завершения плана – серая гребёнка.

Первые два графика в подразделе «Абсолютные» – самые простые и показывают количество выполненных дел каждый день. Они помогают понять, в какие дни пользователь был наиболее продуктивен.
Один из них (чёрный) подсчитывает все задачи, то есть и основные, и второстепенные, а другой (синий) – только основные. Применительно к реальной жизни, разделение этих наборов на отдельные графики имеет определённый смысл: например, человек может погрузиться в выполнение мелких задач, возникающих каждый день, но совсем позабыть об основных задачах, и думать, что он чрезвычайно продуктивен, хотя на самом деле его дела стоят на месте; тогда второй график покажет это.

Третий график – это плановая норма, она рисуется пунктирной линией и строится в зависимости от выбора первых двух. К примеру, если выбраны только основные задачи, то график построится для основных задач и будет соответствующего синего цвета; выбраны оба варианта – будет два графика плановой нормы; не выбрано ничего – график не построится.

Плановая норма отображается только при наличии плана и показывает, сколько задач человек должен был выполнять каждый день, чтобы выполнить всё запланированное и по времени уложиться к выбранной дате окончания плана. Значения рассчитываются путём деления количества оставшихся задач на количество оставшихся дней – это среднее значение, представляющее собой равномерное распределение всех задач по всем дням.
Именно так назван следующий подраздел – «средние», так как это его смысл, и плановая норма – это основной график в нём.

Но плановая норма присутствует и в текущем разделе, так как её наложение на графики выполнений помогает понять, справляется ли пользователь с собственным составленным планом. Если график выполнения не достигает линии нормы, это означает, что на рассматриваемый день выполнено недостаточно задач.
При этом имеется один важный момент: первые графики учитывают все выполнения, а не только тех задач, которые внесены в расписание. Поэтому, если будут выполнены внеплановые задачи, то плановая норма (в данном разделе) подскочит наверх, показывая, что необходимое именно для продвижения в плане количество задач всё ещё не выполнено.

Если данный график уходит наверх, это означает, что пользователь отстаёт от своего плана, так как количество задач, необходимых для выполнения каждый день, увеличивается. Если график уходит вниз – значит, пользователь, наоборот, опережает план. При идеальном следовании плану, график будет горизонтальным.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex07.png)

В подразделе «Средние» первые два графика – это упомянутые выше плановые нормы, для всех задач и для основных. Они строятся точно так же, как в предыдущем подразделе, но сплошной линией и имеют вспомогательные графики, позволяющие анализировать их подробнее.
Вспомогательные графики, так же, как и в предыдущем случае, строятся в зависимости от выбора первых двух, – по одной штуке для каждой.

График бездействия строится мелким пунктиром, рассчитывается так же, как и плановая норма, но с тем отличием, что каждый день берётся одинаковое количество оставшихся задач. Он показывает, как бы выглядела плановая норма, если бы задачи не выполнялись.
«Точкой опоры» является вчерашний день, то есть берётся остаток задач по результатам работы на вчерашний день, который соответственно равен количеству задач на начало сегодняшнего дня.
В начале дня, когда человек ещё не успел ничего сделать, графики идут вместе, а по мере выполнения дел в течение дня плановая норма отклоняется от графика бездействия вниз. И по углу отклонения можно судить о своей продуктивности и приобретать дополнительную мотивацию.

График предсказания, как следует из его названия, предсказывает, как будет выглядеть плановая норма в будущем, исходя из того, как пользователь справлялся задачами в прошлом. Данный график присоединяется к плановой норме справа и является её продолжением, но строится пунктирной линией.
Расчёт отличается тем, что сначала берётся среднее количество выполнений каждый день в прошлом, которое затем вычитается из текущего остатка каждый раз при расчёте каждого следующего дня в будущем, предполагая, что выполнения задач будут идти в том же темпе.
Даже если плановая норма идёт более-менее горизонтально, предсказание может показать, что он в будущем уйдёт, например, вверх. Это поможет заранее принять необходимые меры и начать прилагать немного больше усилий каждый день в выполнении задач, чтобы в будущем неожиданно не обнаружилось большого количества оставшихся невыполненных задач, которые необходимо срочно решить за короткий срок, чтобы успеть к дедлайну.

Реальная и предсказываемая плановая норма практически всегда будет в той или иной мере уходить либо вверх, либо вниз, даже при минимальном отклонении от горизонтали и хорошем следовании плану. Это нормально, так как такова суть данного графика. К примеру, когда человеку осталось выполнить 24 задачи за 12 или за 11 дней – это небольшая разница; а когда остаётся 4 задачи на 2 дня или на 1 день – разница в два раза. Поэтому необходимо принимать во внимание не только форму графика, но и числа по оси Y, и следить, чтобы график не уходил вверх слишком сильно (смотреть, на каком уровне он пересекается с правой границей плана и таким образом определять количество задач, которое останется на последний день плана).

При построении графика предсказания для всех задач, также строится ещё один график, который тоже является пунктирным, но имеет серый цвет.
Он также начинается от конца реальной плановой нормы, сначала спускается вертикально вниз либо поднимается вверх, а затем идёт горизонтально до конца плана.

Он показывает, как должен быть скорректирован план, чтобы при текущем темпе выполнения задач завершить его ровно в запланированный день. Если график, например, спускается вниз, то необходимо проверить длину вертикальной линии в соответствии со шкалой Y и убрать из каждого дня плана именно такое количество задач (или проверить, на каком уровне проходит горизонтальная линия и назначить на каждый день такое количество задач). Если всё сделать именно так, то теоретически график предсказания совпадёт с этим графиком. На практике же рекомендуемое изменение – обычно не целое число, и добиться идеальной горизонтали можно только в редких случаях. Достаточно просто стремиться к максимальному приближению предсказания к горизонтали.
В обратном случае, когда график предсказания уходит вниз и упирается в ноль до того, как доходит до границы плана, ничего плохого в этом нет, это всего лишь означает, что пользователь успешно справляется со своими задачами и, вероятно, досрочно завершит план.
В этом случае серый график предсказания, поднимаясь вверх, говорит о том, что в план можно добавить ещё задач, и всё равно всё будет завершено вовремя. Таким образом можно выполнить больше дел без ущерба основным делам.

При отображении серого графика предсказания, также отображается текстовая подсказка, которая сообщает о том, происходит ли отставание от плана или его опережение, и называет конкретное число задач, которое рекомендуется назначить на каждый день, чтобы вовремя всё завершить, снимая необходимость всматриваться в график и самостоятельно определять это количество.
Если места пересечения чёрного и серого графиков предсказания с правой границей плана отстают друг от друга не более чем на 1 задачу (то есть предсказываемая плановая норма очень близка к горизонтали, что говорит о хорошем следовании плану), то в сообщении будет написано, что пользователь хорошо справляется, и ничего изменять не нужно.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex08.png)

Последний подраздел графиков – это «Временны́е».
Они показывают на сколько именно пользователь отставал от плана или опережал его каждый день в прошлом. Если они находятся в положительной области, то это говорит об опережении; если в отрицательной, значит, происходит отставание. При этом по форме данных графиков можно судить также об изменении ситуации с течением времени: например, если график был ниже нуля, но пошёл наверх, то это означает, что пользователь начал догонять свой план.
Графики наглядно показывают, сколько задач нужно выполнить, чтобы догнать план, или наоборот, на сколько был перевыполнен дневной план.

В данном подразделе есть всего два графика – это график отставания/опережения по задачам и по дням.

Вариант по задачам показывает количество задач, на которые происходит отставание или опережение.
Иногда он может быть недостаточно информативен, потому что на один день может быть назначена, например, всего одна задача, но большая, а на другой – пять мелких. Тогда отставание на одну большую задачу может создать ложное впечатление, что отставание не сильное, и позволить человеку расслабиться, хотя на самом деле нужно спешить, чтобы догнать план.

Для таких ситуаций существует вариант графика по дням. Он имеет тот же самый смысл, но показывает количество дней, а не задач, на которые происходит отставание/опережение. Например, если к некоторому дню задачи выполнялись в соответствии с планом, кроме одного любого дня до это, на который было назначено две задачи, но была выполнена только одна из них, то график будет показывать отставание в этот день на полдня.
Для него производятся такие же расчёты, но каждая задача откладывается по оси Y не на единицу, а на ту долю, которую она составляет от всех задач, назначенных на тот же день. То есть большая единственная за день задача имеет тот же вес, что все пять мелких задач из другого дня, вместе взятые.

Из-за такого отличия графики по задачам и по дням могут даже находиться по разную сторону от нулевой линии. Также график по дням, в отличие от варианта по задачам, может логически не сопоставляться с другими графиками, потому что они тоже рассчитываются по слепому количеству задач, без учёта их «веса».

Из-за того, что график отставания по дням имеет одинаковую единицу измерения по горизонтали и вертикали, появляется интересная возможность. Количество дней отставания или опережения на сегодняшний день (расстояние между графиком и нулём) можно взять и отложить по оси X от правой границы плана. Таким образом получается день, в который будет завершён план (если больше не отставать или не обгонять план). Конечно, данное значение не всегда является целым, поэтому оно округляется программой.
Именно таким образом рассчитывается предсказываемая дата завершения плана, которая отмечается вертикальной линией, такой, как правая граница плана, но серого цвета.

Текстовая подсказка слева от графика по дням сообщает точное количество дней, на которое происходит отставание или опережение на сегодняшний день, и конкретную дату, в которую ожидается завершение плана в соответствии с текущей ситуацией. 

Даже если пользователь опаздывает и продолжает выполнять задачи после наступления дедлайна, эти графики, в отличие от других плановых, продолжают строиться справа от границы плана и показывать предполагаемую дату завершения всех задач.

![alt text](https://github.com/Ryeelevna/NastSecret/blob/main/png_examples/nastex09.png)

Два последних подраздела, неразрывно связанные с расписанием, доступны только тогда, когда имеется созданный пользователем план, и дата его начала уже наступила.

Помимо перечисленных четырёх разделов, некоторые элементы управления расположены в верхнем меню «Настройки».
В его списке опций имеются «Категории задач», о чём говорилось ранее, «Очистить задачи», который удаляет все существующие актуальные задачи и уничтожает расписание, если оно есть, и «Очистить историю», который удаляет все записи о выполнениях и пропусках в прошлом. При очистке истории необходимо иметь в виду, что если имеется расписание, в котором были пропущены задачи, эти пропуски будут заново записаны в историю.

## Использованные инструменты

| Использованные инструменты | Применение |
|:---------------------------|:---------------------------------|
| Библиотека tkinter | Реализация графического интерфейса |
| Библиотека openpyxl | Запись, хранение и считывание данных пользователя в базе данных, представляющей собой файл excel |
| Модуль calendar | Привязка задач к датам и построение временны́х графиков |
| Модуль datetime | Привязка задач к датам и построение временны́х графиков |
| Модуль math | Внутренние расчёты программы |

## Пример кода

```
# расчёты для графиков
pnt = [None for n in range(13)] # значения по оси Y для всех 13 графиков
all_t0 = TpP('0011') # все задачи в плане
com_tt0 = TpP('1011') # все выполнения запланированных задач
com_tt = TpP('1010p') # выполнения запланированных задач, сделанные в период плана 
apdt = Ds([cor[1],cor[2],cor[3],Yn,Mn,Dn]) # количество прошедших дней плана
com_mt0 = com_tt/apdt # среднее количество выполненных (всех) дел за день
# расчёты для графиков предсказания
# проверка наличия галочки на одном из плановых графиков и на графике предсказания
# (предсказание прилагается к одному из основных графиков и не может отображаться без них)
if cor[8][6] and (cor[8][3] or cor[8][4]) and plan: # (cor[8] – значения всех чекбоксов)
	if not past:
		ald = Ds([mns[g3-2],mns[g3-1],mns[g3][g2][g1],Yl,Ml,Dl]) # оставшиеся дни плана
		apd = Ds([Yn,Mn,Dn,mns[g3-2],mns[g3-1],mns[g3][g2][g1]]) # прошедшие дни плана
		if cor[8][3]:
			pnt[8] = (all_t0-com_tt0-com_mt0*apd)/ald # для задач всех типов
			pnt[8] = max(0,pnt[8])
			pnt[10] = com_mt0 # график рекомендации
		if cor[8][4]:
			pnt[9] = (all_t1-com_tt1-com_mt1*apd)/ald # только для основных задач
			pnt[9] = max(0,pnt[9])
# формирование списка значений для рисования графиков
if plan and ((mns[g3-2]==Yn and mns[g3-1]==Mn and mns[g3][g2][g1]==Dn) or not past):
	for n in range(3):
		gr_l[8+n].append(x*cor[9]) # запись значений X (x – шаг, cor[9] – масштаб)
		gr_l[8+n].append(pnt[8+n]) # запись значений Y
```
